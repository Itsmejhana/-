<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Type the Longest Word (no paste)</title>
<style>
  :root { --bg:#0b1020; --card:#0f1724; --accent:#7dd3fc; --muted:#94a3b8; color-scheme: dark; }
  body{background:linear-gradient(180deg,#02040a,#081025);font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial;margin:0;min-height:100vh;display:flex;align-items:center;justify-content:center;padding:32px;color:var(--muted)}
  .card{background:var(--card);padding:28px;border-radius:14px;box-shadow:0 8px 30px rgba(2,6,23,0.6);width:100%;max-width:720px}
  h1{margin:0 0 6px 0;color:white;font-size:20px}
  p{margin:0 0 18px 0}
  .target{font-family:ui-monospace,SFMono-Regular,Menlo,monospace;background:#071024;padding:10px;border-radius:8px;color:var(--accent);overflow:auto;white-space:nowrap}
  textarea{width:100%;height:120px;margin-top:14px;padding:12px;border-radius:8px;background:#021226;border:1px solid rgba(125,211,252,0.06);color:white;font-size:15px;resize:none;outline:none}
  .progress{height:12px;background:#061423;border-radius:999px;margin-top:12px;overflow:hidden}
  .bar{height:100%;width:0;background:linear-gradient(90deg,var(--accent),#60a5fa);transition:width .12s linear}
  .status{display:flex;justify-content:space-between;align-items:center;margin-top:10px;color:var(--muted);font-size:13px}
  .hint{color:#9ca3af;font-size:13px;margin-top:10px}
  button{margin-top:14px;padding:8px 12px;border-radius:8px;border:0;background:var(--accent);color:#021025;font-weight:600;cursor:pointer}
</style>
</head>
<body>
  <div class="card" role="main">
    <h1>Type the longest common English word â€” by hand</h1>
    <p>Type the word below without pasting. The field rejects any character that doesn't match the next expected letter.</p>

    <div class="target" id="targetText">pneumonoultramicroscopicsilicovolcanoconiosis</div>

    <textarea id="typeBox" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" placeholder="Start typing here..."></textarea>

    <div class="progress" aria-hidden="true"><div class="bar" id="bar"></div></div>
    <div class="status">
      <div id="count">0 / 45</div>
      <div id="message">Waiting for you to start typing.</div>
    </div>

    <div class="hint">Pasting, dragging text, right-click paste, and Ctrl/Cmd+V are blocked. If you try to insert a wrong character it will be ignored.</div>
    <button id="resetBtn">Reset</button>
  </div>

<script>
(function(){
  // Target word (common "longest" dictionary word)
  const TARGET = "pneumonoultramicroscopicsilicovolcanoconiosis";
  const MAX = TARGET.length;

  const textarea = document.getElementById("typeBox");
  const bar = document.getElementById("bar");
  const count = document.getElementById("count");
  const message = document.getElementById("message");
  const resetBtn = document.getElementById("resetBtn");

  // Keep previous valid value to revert on invalid programmatic changes
  let prevValid = "";

  // Prevent paste via keyboard shortcuts
  document.addEventListener("keydown", e => {
    // block Ctrl/Meta + V
    if ((e.ctrlKey || e.metaKey) && e.key.toLowerCase() === "v") {
      e.preventDefault();
      flashMessage("Pasting is disabled.");
    }
  }, {capture:true});

  // Prevent right-click paste
  textarea.addEventListener("contextmenu", e => {
    e.preventDefault();
    flashMessage("Context menu disabled here.");
  });

  // Prevent dropping text
  textarea.addEventListener("drop", e => {
    e.preventDefault();
    flashMessage("Dropping text is disabled.");
  });

  // Intercept onpaste
  textarea.addEventListener("paste", e => {
    e.preventDefault();
    flashMessage("Pasting is disabled.");
  });

  // When input happens, only accept characters that match the expected next characters.
  textarea.addEventListener("input", e => {
    const v = textarea.value || "";
    // We only allow forward typing that matches the prefix of TARGET.
    // If user tries to insert text (pasting, autocomplete, or pasting via devtools), we revert.
    if (TARGET.startsWith(v)) {
      // valid prefix
      prevValid = v;
      updateUI(v.length);
      if (v.length === MAX) {
        message.textContent = "Success! You typed the whole word manually. ðŸŽ‰";
        textarea.blur();
      } else {
        message.textContent = "Keep going â€” correct so far.";
      }
    } else {
      // Reject change: restore last valid value and show notice.
      textarea.value = prevValid;
      // move caret to end
      textarea.setSelectionRange(prevValid.length, prevValid.length);
      flashMessage("Only the next correct letter is accepted. Wrong input ignored.");
      updateUI(prevValid.length);
    }
  });

  // Observe attribute/value changes that are not from typing and revert them.
  // This helps detect programmatic changes (not foolproof vs console).
  const mo = new MutationObserver(muts => {
    const v = textarea.value || "";
    if (!TARGET.startsWith(v)) {
      // revert to prevValid if mutated programmatically
      if (textarea.value !== prevValid) {
        textarea.value = prevValid;
        textarea.setSelectionRange(prevValid.length, prevValid.length);
        flashMessage("Automatic changes are blocked.");
      }
      updateUI(prevValid.length);
    }
  });
  mo.observe(textarea, {attributes:true, childList:true, subtree:true, characterData:true});

  // Small visual flash message
  let msgTimer = null;
  function flashMessage(txt){
    clearTimeout(msgTimer);
    message.textContent = txt;
    msgTimer = setTimeout(() => {
      // only revert to default if not complete
      if (textarea.value.length !== MAX) message.textContent = "Keep going â€” correct so far.";
    }, 1600);
  }

  function updateUI(len){
    const pct = Math.round((len / MAX) * 100);
    bar.style.width = pct + "%";
    count.textContent = `${len} / ${MAX}`;
  }

  resetBtn.addEventListener("click", () => {
    textarea.value = "";
    prevValid = "";
    updateUI(0);
    message.textContent = "Reset. Start typing the word manually.";
    textarea.focus();
  });

  // Focus the textarea on load
  textarea.focus();

  // Accessibility: announce the target length
  document.title = `Type the word (${MAX} letters)`;

  // Prevent middle-click paste in some browsers (on Linux)
  textarea.addEventListener("auxclick", e => {
    if (e.button === 1) {
      e.preventDefault();
      flashMessage("Middle-click paste is disabled.");
    }
  });

  // Initialize UI
  updateUI(0);

  // Note: It's impossible to fully prevent someone determined from injecting text via devtools or browser extensions.
  // This script prevents normal paste/drop/context-menu/keyboard paste and refuses characters that don't match the target.
})();
</script>
</body>
</html>
